## muzzle_detection
# problem statement 
Cattle insurance claims in India mandate submitting a deceased ( or died) animal's ear with a tag, leading to widespread fraud. A primitive system lacking verification allows a high volume of false claims, urging the need for a more secure verification process. 
Here we have come up with solution for this. Every cattle has different muzzle. And by using the same we have created ML model to detect and check if the cattle is same or not. 
# detection and annotation
We have implemented a Convolutional Neural Network (CNN) architecture to develop a model capable of detecting and annotating the muzzles of cows in images captured by a camera. This model is designed to identify the muzzles and draw rectangles around them. The dataset used for training and evaluation was meticulously created by capturing 34 images in a nearby cowshed, ensuring that the entire face of the cow was visible with a specific focus on the muzzles.
To enhance our dataset and improve model robustness, we applied data augmentation techniques using the Albumentations library. This allowed us to expand our original 34 images into a larger dataset comprising over 1000 images. The augmented data was then divided into distinct subsets for training, validation, and testing.
The model uses the following libarry it uses the following libraries tensorflow, uuid, keras, os, cv2,json,numpy,matplotlib, PILLOW. It is worth noting that the entire dataset used in this project was curated and created by our team, ensuring that we have complete control over the data quality and accuracy, which is essential for building a reliable model.After the preparation of data, The neural network model uses a VGG16-based architecture to process images. The Classification head predicts the presence of a cow muzzle.Bounding Box Regression Head predicts the coordinates of a bounding box around the cow muzzle. The model is further trained on a custom training loop with binary classification and regression losses and further evaluation on test dataset is done using the defined loss functions.
Output of this code will have annotated image where a rectangle will be drawn around the muzzle of cattle. This will be input for further process of feature extraction and matching.
# feature extraction 
We have used VGG16 as pretrained model for feature extraction. We have droped out last two layers to get features of the muzzle. For this only muzzle will be our input image. By only using muzzle instead of whole face we are trying to extract more relevent features so that we can get high accuracy. we used target size of (224,224) and reshaped it. After preprocessing our image we have extracted features and saved them using pickle library. If we get a image of new cattle to register then we will need to extract features and compare them with the features in our dataset.
# checking similarity
First we have load the folder of features that are in our dataset. Then we have extracted the features of new images using the same method as previous. By using cosine similarities we are finding if our image already exists in our dataset or not. For this we have used similarity thershhold as 0.9 . After runing loop for whole feature folder if the best similarity can be found more than 0.9 then it will give output as "match found" else "match not found" 
